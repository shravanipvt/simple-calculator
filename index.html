<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calculator</title>
  <style>
    :root{--bg:#0f1724;--panel:#0b1220;--accent:#10b981;--btn:#111827;--muted:#94a3b8}
    *{box-sizing:border-box}
    body{min-height:100vh;display:flex;align-items:center;justify-content:center;margin:0;background:linear-gradient(180deg,#061226, #071430);font-family:Inter,system-ui,Arial}
    .calc{width:320px;max-width:94vw;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.02));border-radius:14px;padding:18px;box-shadow:0 10px 30px rgba(2,6,23,0.6)}
    .display{height:64px;background:var(--panel);border-radius:8px;padding:10px 12px;color:#e6eef6;display:flex;flex-direction:column;justify-content:center;align-items:flex-end;font-size:20px}
    .expr{color:var(--muted);font-size:12px;opacity:0.9}
    .out{font-weight:600;font-size:24px}
    .keys{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:12px}
    button{height:56px;border-radius:10px;border:0;background:var(--btn);color:#e6eef6;font-size:18px;cursor:pointer;box-shadow:inset 0 -2px 0 rgba(255,255,255,0.02)}
    button.op{background:transparent;color:var(--accent);border:1px solid rgba(255,255,255,0.04)}
    button.wide{grid-column:span 2}
    footer{font-size:12px;color:var(--muted);text-align:center;margin-top:12px}
    @media (max-width:400px){.display{height:56px;font-size:18px}.out{font-size:20px}}
  </style>
</head>
<body>
  <main class="calc" role="application" aria-label="Simple calculator">
    <div class="display" id="display">
      <div class="expr" id="expr">&nbsp;</div>
      <div class="out" id="out">0</div>
    </div>

    <div class="keys" id="keys">
      <button class="op" data-action="clear">AC</button>
      <button class="op" data-action="neg">+/-</button>
      <button class="op" data-action="percent">%</button>
      <button class="op" data-value="/">÷</button>

      <button data-value="7">7</button>
      <button data-value="8">8</button>
      <button data-value="9">9</button>
      <button class="op" data-value="*">×</button>

      <button data-value="4">4</button>
      <button data-value="5">5</button>
      <button data-value="6">6</button>
      <button class="op" data-value="-">−</button>

      <button data-value="1">1</button>
      <button data-value="2">2</button>
      <button data-value="3">3</button>
      <button class="op" data-value="+">+</button>

      <button class="wide" data-value="0">0</button>
      <button data-value=".">.</button>
      <button class="op" data-action="equals">=</button>
    </div>

    
  </main>

  <script>
    (function(){
      const exprEl = document.getElementById('expr');
      const outEl = document.getElementById('out');
      const keys = document.getElementById('keys');

      let expr = '';

      function sanitize(s){
        // allow digits, parentheses, dot and operators + - * / %
        return s.replace(/[^0-9()+\-*/%.]/g,'');
      }

      function update(){
        exprEl.textContent = expr || '\u00A0';
        outEl.textContent = expr ? tryEval(expr) : '0';
      }

      function tryEval(s){
        try{
          const clean = sanitize(s);
          // convert % to /100 for simple percentage handling
          const withPercent = clean.replace(/(\d+(?:\.\d+)?)%/g,'($1/100)');
          // safely evaluate using Function
          const val = Function('return (' + withPercent + ')')();
          if (val === undefined || Number.isNaN(val) || !isFinite(val)) return '';
          return String(val);
        }catch(e){return 'Error'}
      }

      keys.addEventListener('click', e =>{
        const t = e.target;
        if (!t.matches('button')) return;
        const v = t.getAttribute('data-value');
        const action = t.getAttribute('data-action');
        if (action=== 'clear'){ expr = ''; update(); return; }
        if (action=== 'neg'){
          // try to negate the last number
          expr = expr.replace(/(\d+\.?\d*)$/,(m)=>"("+"-"+m+")"); update(); return;
        }
        if (action=== 'percent'){ expr += '%'; update(); return; }
        if (action=== 'equals') { expr = tryEval(expr); if (expr!=='Error') expr = String(expr); update(); return; }
        if (v){ expr += v; update(); }
      });

      // keyboard support
      document.addEventListener('keydown', (e)=>{
        if (e.key === 'Enter'){ e.preventDefault(); const res = tryEval(expr); expr = res === '' ? '' : String(res); update(); return; }
        if (e.key === 'Backspace'){ expr = expr.slice(0,-1); update(); return; }
        if (e.key === 'Escape'){ expr = ''; update(); return; }
        // allow digits and operators
        if (/^[0-9+\-*/().%]$/.test(e.key)){
          expr += e.key; update(); return;
        }
      });

      // init
      update();
    })();
  </script>
</body>
</html>
